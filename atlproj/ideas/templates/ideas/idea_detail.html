{% extends "ideas/index.html" %}

{% load ideas_extras %}

	{% block ideas-nav %} active{% endblock %}
    {% block title %}{{ object }}{% endblock %}
    
    {% block content %}
	{% if idea %}
	<h1 class="display-4">{{ idea }} {% if request.user.is_staff %}<a class="btn btn-primary" href="{% url 'admin:ideas_idea_change' idea.id %}">Edit</a>{% endif %}</h1>
	
	<h4>{% if idea.platform %}<span class="badge badge-info">{{ idea.platform.title }}</span>{% endif %} {% if idea.parent %}Part of <a href="{% url 'idea_detail' idea.parent.id %}">{{ idea.parent }}</a>{% endif %}</h4>
	
	{% if idea.description %}<p class="lead">{{ idea.description }}</p>{% endif %}
	
	<ul>
	{% if idea.date_submitted %}
	<li><strong>Date submitted:</strong> {{ idea.date_submitted|date:"F j, Y" }}</li>
	{% endif %}
	{% if idea.marketing_title %}
	<li><strong>Marketing title:</strong> {{ idea.marketing_title }}</li>
	{% endif %}
	{% if idea.status %}
	<li><strong>Status:</strong> {{ idea.get_status_display }}</li>
	{% endif %}
	{% if idea.notes %}
	<li><strong>Notes:</strong> {{ idea.notes }}</li>
	{% endif %}
	</ul>
	
	{% if idea.idea_set.all %}
	<hr />
	
	<h3>Components</h3>
	
	    <table class="table mt-3">
	    	<thead>
	    		<tr>
	    			<th>Title</th>
	    			<th>Date added</th>
	    			<th>Status</th>
	    			<th class="w-50">Description</th>
	    		</tr>
	    	</thead>
	    	<tbody>
		{% for child in idea.idea_set.all %}
	        	<tr>
	        		<td><a href="{% url 'idea_detail' child.pk %}">{{ child }}{% if child.marketing_title %} (Marketing title: {{ child.marketing_title }}){% endif %}</child></a></td>
	        		<td>{{ child.date_submitted|date:"F j, Y" }}</td>
	        		<td>{% if child.status %}{{ child.get_status_display }}{% endif %}</td>
	        		<td class="w-50">{% if child.platform %}<span class="badge badge-info">{{ child.platform.title }}</span> {% endif %}{{ child.description }}</td>
	        	</tr>
		{% endfor %}
			</tbody>
		</table>
		
	{% endif %}
	
	{% else %}
	    <p>This is not a valid idea! Try again!</p>
	{% endif %}

	{% if request.user|has_group:"Sales" %}
	{% if idea.pitch_set.all %}
    
	<hr />
	<h3>Pitches</h3>
	
	<table class="table mt-3">
    	<thead>
    		<tr>
    			<th>Client</th>
    			<th>Updated</th>
    			<th>Status</th>
    			<th>Edit</th>
    			<th class="w-50">Notes</th>
    		</tr>
    	</thead>
    	<tbody>
		{% for pitch in idea.pitch_set.all %}
			<tr>
				<td>{{ pitch.client }}</td>
				<td>{{ pitch.date_updated }}</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
		{% endfor %}
		</tbody>
	</table>
	
	{% endif %}
	{% endif %}
	
	
	{% endblock %}